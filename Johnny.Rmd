---
title: "36-315"
author: "Group Number: 19, Names: Julien Naegeli, Alex Frazier, Johnny Wu, Maria Rodriguez: jnaegeli, afrazie1, johnnywu, mar1"
date: "Due Monday"
output: 
  html_document:
    toc:  true
    toc_float:  true
    code_folding:  show

---


```{r}
library(dplyr)
library(readr)
library(ggplot2)

indicators <- read_csv("../Indicators.csv")
indicators <- select(indicators, CountryCode, IndicatorCode, Value, Year)
Countries <- read_csv("../Country.csv")
Countries <- select(Countries, CountryCode, ShortName)
Countries <- mutate(Countries, top_20 = ifelse(ShortName %in% c("Qatar", "Luxembourg", 
                                     "Singapore", "Brunei", "Kuwait", "Norway", "United Arab Emirates", "Hong Kong", "United States", "Switzerland", "Saudi Arabia", "Bahrain", "Netherlands", "Ireland", "Australia", "Austria", "Sweden", "Germany", "Taiwan", "Canada"), "Top 20 Richest Country", "Not Top 20"))
Countries
```

```{r}
#GDP (current LCU)
Variables <- merge(Countries, filter(indicators, IndicatorCode=="NY.GDP.MKTP.CD" &  Year==2012 & Value > 1e+3), by = 'CountryCode')
names(Variables)[names(Variables)=="Value"] <- "GDP"

#Survival rate to the last grade of primary education, both sexes (%)
Variables <- merge(Variables, filter(indicators, IndicatorCode=="SE.PRM.PRSL.ZS" &  Year==2012), by = 'CountryCode')
names(Variables)[names(Variables)=="Value"] <- "Mortality"

GDPMortality <- Variables

#Central government debt, total (% of GDP)
Variables2 <- merge(Countries, filter(indicators, IndicatorCode=="GC.DOD.TOTL.GD.ZS" &  Year==2012), by = 'CountryCode')
names(Variables2)[names(Variables2)=="Value"] <- "Debt"

#Expense (% of GDP)
Variables2 <- merge(Variables2, filter(indicators, IndicatorCode=="GC.XPN.TOTL.GD.ZS" &  Year==2012), by = 'CountryCode')
names(Variables2)[names(Variables2)=="Value"] <- "Expense"


#countsCountry <- indicators %>%
#  group_by(CountryCode, CountryName) %>%
#  summarise(NumIndicators = n_distinct(IndicatorName),
#            NumYears      = n_distinct(Year),
##            FirstYear     = min(Year),
#            LastYear      = max(Year))

#countsIndicate <- indicators %>%
#  group_by(IndicatorCode, IndicatorName) %>%
#  summarise(NumCountries = n_distinct(CountryName),
#            NumYears     = n_distinct(Year),
#            FirstYear    = min(Year),
#            LastYear     = max(Year))

# Note - $ being replaced with dollar to avoid MathJax issue
#counts$IndicatorName <- gsub("\\$", "dollar", counts$IndicatorName)
#print.table(counts)
```

Graphings
```{r}
gdp_mortality_debt_allCountry <- indicators %>% 
  group_by(CountryName, Year, IndicatorName) %>%
  filter(IndicatorName == "GDP (current LCU)" |
         IndicatorName == "Mortality rate, under-5 (per 1,000)" | 
         IndicatorName == "Central government debt, total (% of GDP)" | 
         IndicatorName == "Military expenditure (% of GDP)")
```
```{r}

south_america <- gdp_mortality_debt_allCountry %>%
  filter(CountryName == "Brazil" |
         CountryName == "Argentina" | 
         CountryName == "Paraguay" | 
         CountryName == "Uruguay" |
         CountryName == "Chile" | 
         CountryName == "Bolivia" | 
         CountryName == "Peru" | 
         CountryName == "Ecuador" | 
         CountryName == "Colombia" | 
         CountryName == "Venezuela" | 
         CountryName == "Guyana" | 
         CountryName == "Suriname" )


gdpL <- filter(gdp_mortality_debt_allCountry, IndicatorName == "GDP (current LCU)")
nationalDebt <- filter(gdp_mortality_debt_allCountry, IndicatorName == "Central government debt (% of GDP)")

#gdpL_nationalDebt <- merge(gdpL, nationalDebt, by.x = "CountryName")
jnaegeli_315_theme <-  theme_bw() + 
  theme(
    axis.text = element_text(size = 10, family = "Palatino", 
                                 color = "royalblue4"),
        text = element_text(size = 14, family = "Palatino",
                            face = "bold", color = "grey30"))

#actually GDP^1/4 vs primary education survival rate
ggplot(GDPMortality, aes(x = GDP ^ (1/4), y = Mortality, label = ShortName)) + geom_point(aes(color = top_20)) + 
  labs(
    title = "GDP vs Primary Education Survival Rate",
    x = "GDP (current US Dollar)",
    y = "Survival rate past primary education (%)",
    color = "Country GDP per capita Ranking"
  ) + geom_smooth() + jnaegeli_315_theme + theme(legend.position="bottom")

#+
  #geom_text(data=subset(GDPMortality, GDP ^ (1/4) > 2000), check_overlap = TRUE)


ggplot(Variables2, aes(x = Expense, y = Debt, label = ShortName)) + geom_point(aes(color = top_20)) + 
  labs(
    title = "Government Expenses vs Government Debt",
    x = "Expenses (% of GDP)",
    y = "Central government debt, total (% of GDP)", 
    color = "Country GDP per capita Ranking"
  ) + geom_smooth() +
  geom_text(data=subset(Variables2, Debt > 150)) + jnaegeli_315_theme + theme(legend.position="bottom")
#REMEMBER TO LABEL OUTLIER POINTS AND COLOR THE POINTS AS WELL

#ggplot(nationalDebt, aes(x = Year, y = Value)) + geom_point() + 
#  labs(
#    title = "Government Debt over the years",
#    x = "Central government debt total (% of GDP)",
#    y = "Year"
#  )

#ggplot(gdpL, aes(x = Year, y = Value)) + geom_point() + 
#  labs(
#    title = "GDP over the years",
#    x = "GDP (current LCU)",
#    y = "Year"
#  )
```


1st Graph:
The graph shows National Debt for the Central government of countries. There does not seem to be any sort of trend, suggesting that debt is independent of time. There seems to be an equilibrium between the accruation and spending of money for these country governments

2nd Graph:
This graph shows GDP over time. It seems that as time increases, GDP does as well. This is because as countries interact, mutual benefits and trades will allow each country to grow richer in GDP.



